namespace Atari2600.Emulator.Tia;

public class AtariColor(byte value) {
    private static readonly Dictionary<int, string> ColorMap = new() {
                                                                         { 0x00, "#000000" },
                                                                         { 0x10, "#444400" },
                                                                         { 0x20, "#702800" },
                                                                         { 0x30, "#841800" },
                                                                         { 0x40, "#880000" },
                                                                         { 0x50, "#78005C" },
                                                                         { 0x60, "#480078" },
                                                                         { 0x70, "#140084" },
                                                                         { 0x80, "#000088" },
                                                                         { 0x90, "#00187C" },
                                                                         { 0xA0, "#002C5C" },
                                                                         { 0xB0, "#003C2C" },
                                                                         { 0xC0, "#003C00" },
                                                                         { 0xD0, "#143800" },
                                                                         { 0xE0, "#2C3000" },
                                                                         { 0xF0, "#442800" },
                                                                         { 0x02, "#404040" },
                                                                         { 0x12, "#646410" },
                                                                         { 0x22, "#844414" },
                                                                         { 0x32, "#983418" },
                                                                         { 0x42, "#9C2020" },
                                                                         { 0x52, "#8C2074" },
                                                                         { 0x62, "#602090" },
                                                                         { 0x72, "#302098" },
                                                                         { 0x82, "#1C209C" },
                                                                         { 0x92, "#1C3890" },
                                                                         { 0xA2, "#1C4C78" },
                                                                         { 0xB2, "#1C5C48" },
                                                                         { 0xC2, "#205C20" },
                                                                         { 0xD2, "#345C1C" },
                                                                         { 0xE2, "#4C501C" },
                                                                         { 0xF2, "#644818" },
                                                                         { 0x04, "#6C6C6C" },
                                                                         { 0x14, "#848424" },
                                                                         { 0x24, "#985C28" },
                                                                         { 0x34, "#AC5030" },
                                                                         { 0x44, "#B03C3C" },
                                                                         { 0x54, "#A03C88" },
                                                                         { 0x64, "#783CA4" },
                                                                         { 0x74, "#4C3CAC" },
                                                                         { 0x84, "#3840B0" },
                                                                         { 0x94, "#3854A8" },
                                                                         { 0xA4, "#386890" },
                                                                         { 0xB4, "#387C64" },
                                                                         { 0xC4, "#407C40" },
                                                                         { 0xD4, "#507C38" },
                                                                         { 0xE4, "#687034" },
                                                                         { 0xF4, "#846830" },
                                                                         { 0x06, "#909090" },
                                                                         { 0x16, "#A0A034" },
                                                                         { 0x26, "#AC783C" },
                                                                         { 0x36, "#C06848" },
                                                                         { 0x46, "#C05858" },
                                                                         { 0x56, "#B0589C" },
                                                                         { 0x66, "#8C58B8" },
                                                                         { 0x76, "#6858C0" },
                                                                         { 0x86, "#505CC0" },
                                                                         { 0x96, "#5070BC" },
                                                                         { 0xA6, "#5084AC" },
                                                                         { 0xB6, "#509C80" },
                                                                         { 0xC6, "#5C9C5C" },
                                                                         { 0xD6, "#6C9850" },
                                                                         { 0xE6, "#848C4C" },
                                                                         { 0xF6, "#A08444" },
                                                                         { 0x08, "#B0B0B0" },
                                                                         { 0x18, "#B8B840" },
                                                                         { 0x28, "#BC8C4C" },
                                                                         { 0x38, "#D0805C" },
                                                                         { 0x48, "#D07070" },
                                                                         { 0x58, "#C070B0" },
                                                                         { 0x68, "#A070CC" },
                                                                         { 0x78, "#7C70D0" },
                                                                         { 0x88, "#6874D0" },
                                                                         { 0x98, "#6888CC" },
                                                                         { 0xA8, "#689CC0" },
                                                                         { 0xB8, "#68B494" },
                                                                         { 0xC8, "#74B474" },
                                                                         { 0xD8, "#84B468" },
                                                                         { 0xE8, "#9CA864" },
                                                                         { 0xF8, "#B89C58" },
                                                                         { 0x0A, "#C8C8C8" },
                                                                         { 0x1A, "#D0D050" },
                                                                         { 0x2A, "#CCA05C" },
                                                                         { 0x3A, "#E09470" },
                                                                         { 0x4A, "#E08888" },
                                                                         { 0x5A, "#D084C0" },
                                                                         { 0x6A, "#B484DC" },
                                                                         { 0x7A, "#9488E0" },
                                                                         { 0x8A, "#7C8CE0" },
                                                                         { 0x9A, "#7C9CDC" },
                                                                         { 0xAA, "#7CB4D4" },
                                                                         { 0xBA, "#7CD0AC" },
                                                                         { 0xCA, "#8CD08C" },
                                                                         { 0xDA, "#9CCC7C" },
                                                                         { 0xEA, "#B4C078" },
                                                                         { 0xFA, "#D0B46C" },
                                                                         { 0x0C, "#DCDCDC" },
                                                                         { 0x1C, "#E8E85C" },
                                                                         { 0x2C, "#DCB468" },
                                                                         { 0x3C, "#ECA880" },
                                                                         { 0x4C, "#ECA0A0" },
                                                                         { 0x5C, "#DC9CD0" },
                                                                         { 0x6C, "#C49CEC" },
                                                                         { 0x7C, "#A8A0EC" },
                                                                         { 0x8C, "#90A4EC" },
                                                                         { 0x9C, "#90B4EC" },
                                                                         { 0xAC, "#90CCE8" },
                                                                         { 0xBC, "#90E4C0" },
                                                                         { 0xCC, "#A4E4A4" },
                                                                         { 0xDC, "#B4E490" },
                                                                         { 0xEC, "#CCD488" },
                                                                         { 0xFC, "#E8CC7C" },
                                                                         { 0x0E, "#ECECEC" },
                                                                         { 0x1E, "#FCFC68" },
                                                                         { 0x2E, "#ECC878" },
                                                                         { 0x3E, "#FCBC94" },
                                                                         { 0x4E, "#FCB4B4" },
                                                                         { 0x5E, "#ECB0E0" },
                                                                         { 0x6E, "#D4B0FC" },
                                                                         { 0x7E, "#BCB4FC" },
                                                                         { 0x8E, "#A4B8FC" },
                                                                         { 0x9E, "#A4C8FC" },
                                                                         { 0xAE, "#A4E0FC" },
                                                                         { 0xBE, "#A4FCD4" },
                                                                         { 0xCE, "#B8FCB8" },
                                                                         { 0xDE, "#C8FCA4" },
                                                                         { 0xEE, "#E0EC9C" },
                                                                         { 0xFE, "#FCE08C" }
                                                                     };

    public static string[] AllColors => AtariColor.ColorMap.Values.ToArray();

    public string Hex => AtariColor.ColorMap[value & 0xFE];

    public string GetConsoleColor() {
        byte[] Bytes = Convert.FromHexString(this.Hex.Substring(1));
        return $"\e[38;2;{Bytes[0]};{Bytes[1]};{Bytes[2]}m";
    }
}